import{_ as p,a as l,U as r,r as _,o as h,c as g,b as t,w as i,v as c,d as m,e as u,f as k,p as f,g as w}from"./index-b39d0e26.js";const y={name:"Login",mounted(){localStorage.clear()},data(){return{email:"",password:""}},methods:{async token(){try{let o=JSON.parse(localStorage.getItem("token")).refresh_token;console.log(o);let s=await l.post(`${r}/api/refresh`,{refresh_token:o});window.localStorage.setItem("token",JSON.stringify(s.data)),console.log(s)}catch(e){console.log("refresh token error"),console.log(e)}},async me(){this.token();try{const o={"Content-Type":"application/json",authorization:`Bearer ${JSON.parse(localStorage.getItem("token")).access_token}`};let s=await l.get(`${r}/api/me`,{headers:o});console.log(s),localStorage.setItem("detail",JSON.stringify({name:s.data.name}))}catch(e){console.log(e)}},async Login(){let e;try{if(this.email!=""&&this.password!=""){e=await l.post(`${r}/api/login`,{email:this.email,password:this.password}),console.log(e);let o={access_token:e.data.access_token,refresh_token:e.data.refresh_token};window.localStorage.setItem("token",JSON.stringify(o)),console.log("below"),console.log(e),e.status===200&&(this.me(),this.$router.push({name:"home"}))}else alert("All fileds are required")}catch(o){console.log(o),alert(o.response.data.message)}}}},n=e=>(f("data-v-6f93150c"),e=e(),w(),e),S={class:"login"},v={class:"login-container"},x=n(()=>t("span",{class:"span1"},"LOGIN",-1)),I=n(()=>t("label",null,"Email",-1)),L=n(()=>t("label",null,"Password",-1)),N={class:"login-bottom"},$=n(()=>t("label",{class:"login-hyperlink"},"Signup here",-1));function b(e,o,s,O,E,J){const d=_("router-link");return h(),g("div",S,[t("div",v,[x,I,i(t("input",{"onUpdate:modelValue":o[0]||(o[0]=a=>this.email=a),type:"text",placeholder:"Enter Email"},null,512),[[c,this.email]]),L,i(t("input",{"onUpdate:modelValue":o[1]||(o[1]=a=>this.password=a),type:"text",placeholder:"Enter Password"},null,512),[[c,this.password]]),t("button",{onClick:o[2]||(o[2]=(...a)=>this.Login&&this.Login(...a))},"Login"),t("div",N,[t("span",null,[m("Don't have a account? "),u(d,{to:{name:"signup"}},{default:k(()=>[$]),_:1})])])])])}const B=p(y,[["render",b],["__scopeId","data-v-6f93150c"]]);export{B as default};
